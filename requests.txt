can you create a REQUIREMENT_SHORT.md for the short selling algo, similar to REQUIREMENT.md but with opposite
details?  1. please

identify the
common part
for
exsiting
 long algo
  and this new short algo
2,. also use multi lots and grid system



The current algo is Long only, no short selling. can you devise a short selling algo with trailing stop loss?
Some of the parameters need to be changed, as short selling is more risky, so in general the parameters should be more
conservative, e.g., larger profit requirement, larger grid interval, larger trailing short sell activation and
pullback percentage,
larger trailing buy back activation and rebound percentage. Also what could be a stop loss rule liquidation as
short selling can have unlimited loss.
just planning, no code change please


1. the annualized return is still shown as N/A in the table


1. 2nd row is a sell, as indicated in Realized P/L. however the annualized return is N/A , why?
2. Can you log the calulation of average annualized return for all trades in console for debugging purpose?,
3  The Total P/L column does not show. Please check code why it is truncated. css issue? seems last column is cut
off

4. calculate actual total P/L % = Total P/L/ total capital deployed at the time.
add this to the Price Chart with Transaction Markers, use a right hand side Y axis

4. add the B and H P/L % to the Price Chart with Transaction Markers, use the same right hand side Y axis




"4. Annual Return column is working correctly"
 This is the table header :Enhanced Transaction History
                                                                            Date
                                                                            Type
                                                                            Price
                                                                            Trailing Stop Buy
                                                                            Trailing Stop Sell
                                                                            Shares
                                                                            Value
                                                                            Lots
                                                                            Avg Cost
                                                                            Holdings Value
                                                                            Unrealized P&L
                                                                            Realized P&L
                                                                            Total P&L
                                                                            Ann. Return
                                                                  ""
But it is not showing in the table, Can you move the column next to Realized P&L?
5. The average annualized return for all trades is not right, do you have a better way to calculate it?



1. total P&L in the portfolio value chart should be a curve, not a stair step line
2. how do you calculate the average capital deployed during the backtest period? can you also include the number
along with "Total Return
           $56,836.01
           +196.22%"
3. Since "Average Annualized Return
          58.59%

          All positions (trades + holdings)", then given the backtest period is about 4 years, the total return should be about (1 + 58.59%)^4 - 1 = 9.5 times,
          or linearly 4 * 58.59% = 234.36%, not 196.22%. Can you check the calculation?


4. why Annual Return column is not in the Enhanced Transaction History table any more, again make sure use linear
calculation, not math.pow.

5. I think the average annualized return for all trades should be weighted, i.e. if one trade is 100% annualized return but
it is only 1 lot, while another trade is 20% annualized return but it is 10 lots, then the average annualized return should be
(1 * 100% + 10 * 20%) / (1 + 10) = 27.27%, not (100% + 20%) / 2 = 60%, please check the calculation and
implement it.



in "Portfolio Value Over Time" chart,

1. replace "Total Portfolio Value" with total P&L, which can be obtained from "Total P&L" in "Enhanced Transaction
History" table, or = current holdings value - break even value + cumulative realized P&L
2. remove available cash from the chart.
3. "Total Return
   $56,836.01

   +56.84%", what should be the correct calculation for total return % ? the capital deployed changed from time to
   time,
   can you calculate the average capital deployed during the backtest period, and use that to calculate total
   return % ?
4. why Annual Return column is not in the Enhanced Transaction History table any more, again make sure use linear
calculation, not math.pow.




1. the breakeven line should not be a straight line, it should be the average cost of all current lots on each day,
 so it is a curve.
2. the portfolio value should be the sum of current value of all current lots on each day, + the realized P/L on each day,
 so it is
also a curve,
not a stair step line. If you can plot in a way that these two parts in #2 are shown separately, that would be
great.

1. the hover info has the same labels. please correct
2. Total portfolio value should not include the capital not deployed yet.
3. what should be the break-even line? please use more apparent color.
4. what is the dashed line? please use more apparent color.
5 the starting value is incorrect. 10 lots should be $100,000, not $200,000

Please see if these statemnet are correct
1. Cumulative Realized P&L should be match "Realized P&L" in  "Enhanced Transaction History" table, right now they
are different, which one is correct?
2. please add "Current Holdings Value" in "Enhanced Transaction History", it should be shares held * current price
3. #2 should match "Current Holdings Value"  in Portfolio Value Over Time chart
4. The avilable cash should increased once shares are sold, and decreased once shares are bought, when all shares
are sold


6. breakeven line should be the total cost of all current lots, we know each lots is $10k, so it is number of lots
*
 $10k, so when 5 lots are held, it is $50k


7. one way to check is when most shares are sold at $421.06 on 12/19/2024, only lot $173.80 is left,  then
7.1 current
holdings value should be (10000/173.80)(number of shares) * 421.06 = $24,226.70,
7.2 available cash should be $90, 000, since only one lot is left, and cost for each lot is $10,000
7.3  breakeven line should be $10,000, since only one lot is left

most of the calucation are still wrong. Let me give you the result on 7/9/2025. based on this record

"
Enhanced Transaction History
Date
Type
Price
Trailing Stop Buy
Trailing Stop Sell
Shares
Value
Lots
Avg Cost
Holdings Value
Unrealized P&L
Realized P&L
Total P&L
Ann. Return

7/9/2025
 TRAIL BUY
 $309.87
 Limit: $348.68
 Bottom: $293.94
 Stop: $308.64
 32.2716
 $10,000.00
 Held: $410.44, $355.94, $309.87
 $354.06
 $0.00
 -$3,744.62
 $58,547.10
 $54,802.48
"

losts = $410.44, $355.94, $309.87]
therefore:

8.1 current
holdings value should be just like in Current Holdings table:

Purchase Date
Purchase Price
Shares
Current Price
Current Value
P&L
Ann. Return
1/2/2025
$410.44
24.3641
$333.87
$8,134.44
-$1,865.56
-28.25%
2/12/2025
$355.94
28.0946
$333.87
$9,379.95
-$620.05
-11.32%
7/9/2025
$309.87
32.2716
$333.87
$10,774.52
$774.52
53.34%
"
it is $8,134.44 + $9,379.95 + $10,774.52 = $28,289.91

8.2 available cash should be $70, 000, since only 3 lot is held, and cost for each lot is $10,000
8.3  breakeven line should be $30,000, since only 3 lot is held
8.4 cumulative realized P&L should be $58,547.10
8.4 Total portfolio value should be $28,289.91 + $58,547.10 = $86,837.01

Please make sure your implementation matches these calculation.


Current backtest configuration for example:
5.2 Backtest Configuration
{
  "symbol": "TSLA",
  "startDate": "2021-11-01",
  "endDate": "2023-11-01",
  "lotSizeUsd": 10000,
  "maxLots": 10,
  "maxLotsToSell": 1,
  "gridIntervalPercent": 0.10,
  "profitRequirement": 0.05,
  "trailingBuyActivationPercent": 0.10,
  "trailingBuyReboundPercent": 0.05,
  "trailingSellActivationPercent": 0.20,
  "trailingSellPullbackPercent": 0.10
}

there are correlation between these parameters. Let's add 1 more parameter sto manage these correlation:
1. each stock should have a Beta, can this be quoted from yahoo finance or other source?
If no, default to 1, but allow user to change it on the parameter page.
2. allow user to set multiple Beta for batch backtest. .25, .5, 1, 1.5, 2, 3
Then we can set these parameters based on Beta:
   profitRequirement = 0.05 * Beta
   gridIntervalPercent = 0.1 * Beta
Then we can set these parameters based on Beta:
   trailingBuyActivationPercent = 0.1 * Beta
   trailingBuyReboundPercent = 0.05 * Beta
   trailingSellActivationPercent = 0.2 * Beta
   trailingSellPullbackPercent = 0.1 * Beta



after runnning backtest, clicking on the parameters page, it immediately switch to single backtest result with the
full URL with parameters, instead of staying on the parameters page.


1. in batch result page , Detailed Results table, I click run on a row for PLTR, but then it shows result for the
LMND, it does not pass the whole parameters set for that row to the single backtest page to run the single backtest
.

2. can you log important events and data to the console for debugging purpose? for example, when user click run on
a row for PLTR,
log the parameters set for that row to the console, then log that backtest run with what parameters

3. do you need to convert

"4. Investigated 1000% Annual Return calculation issue
   - Root cause: Very short holding periods (1-3 days) with the exponential annualized return formula
   - Formula Math.pow(1 + returnPercent, 365 / actualDaysHeld) - 1 creates extreme values for short periods
   - Found multiple calculation bugs and inconsistencies in the codebase
   - The 1000% return is mathematically correct but unrealistic due to extrapolating short-term gains over a full
   year

"
let's change math.pow to simply multiplication => returnPercent * 365 / actualDaysHeld
Also in summary table, it should be average annualized return for all trades, not just one trade with large
annualized return, right?


Please add these requirement and implement in code

1. single backtest result page should list all the parameters used in the backtest
2. in batch result page, "Best for Total Return
                          Profit: 5.00%
                          Grid: 10.00%
                          Buy Activation: 10.00%
                          Sell Activation: 20.00%
" is incomplete, should add Buy rebound and Sell Pullback value
3. in batch result page , Detailed Results table, please add Buy rebound and Sell Pullback columns
4. for PLTR , it shows "1	PLTR	76.73%	1000.00%	14	100.00%	$4,384.73	61.25%	41.49%	5.00%	10.00%	10.00%	20
.00%" , why Annual Return	= 1000% ? is it correct?



This still does not work. I updated the description.
1. Navigation and persistence
Each page should persist the selection when user navigate back and forth
e.g., I make selection in the Parameter->batch Optimization Tab, then run the batch backtest, then go
back to
the parameters page, it should stay on the batch Optimization Tab, and the previous selection like multiple profit
requirement,  should still be there.


2. When click on Run Backtest Again button in the comparison table, can it open a new tab  instead of new window?
3. The rerun on the new tab/page does not work, please add debugging log to see where the problem is.


please parameterize these values:

1. when price drops 10% from the recent local peak, start a trailing stop limit order.
   stop price is 5% higher than the current price.
2. when price rise 20% from the recent local bottom, start a trailing stop limit order.
   stop price is 10% lower than the current price.

3. change the current loss_tolerance to profit_requirement, default to 0.05 (5%), so the number is positive while
previous number is negative. so formula and calculation need to be changed accordingly.

4.  use this profit_requirement to this rule:

Execute: only if execution price > limit price AND execution price > average cost * (1 + profit_requirement)
Cancellation: Cancel when current price ‚â§ average cost * (1 + profit_requirement) (no longer meet the profit requirement)

5. develop a backtest engine to emulate various parameters and generate a report to compare the results.

These parameters can be fixed:
    lot size USD = 10,000
    max lots = 10
    start date = 2021-09-01
    end date = 2025-09-01

There parameters can be changed:
    Stocks = ['TSLA', 'NVDA', 'AAPL', 'MSFT', 'AMZN', 'PLTR', 'U', 'META', 'SHOP', 'TDOC', 'JD', 'BABA', 'LMND',
    'NIO', 'KNDI', 'API'], default to  'TSLA'
    allow user to select one or more stocks

    profit_requirement        = 0 - .5     with interval of 0.05 (5%), default to 0.05 (5%)
    grid interval percentage  = 0.05 - 0.2 with interval of 0.05 (5%), default to 0.10 (10%)

    trailing buy activation(drop) percentage  = 0.05 - 0.2 with interval of 0.05 (5%), default to 0.10 (10%)
    trailing buy rebound percentage           = 0.0 - 0.1  with interval of 0.05 (5%), default to 0.05 (5%)
    trailing sell activation(rise) percentage = 0.1 - 0.5 with interval of 0.1 (5%), default to 0.20 (20%)
    trailing sell Pullback percentage         = 0.0 - 0.1  with interval of 0.05 (5%), default to 0.10 (10%)

6. Add these to UI, and allow user to either run one backtest with selected parameters or run a series of backtest with all combinations of the parameters to generate a report to compare the results.
report should include:
    total return, (how is it calculated?)
    annualized return
    total number of buy and sell trades
    win rate (number of profitable trades / total number of trades)
    average profit per trade
    maximum drawdown
    capital utilization rate (total capital used for buying lots / total capital available)
    The best parameters combination for each stock, in terms of total return and annualized return.

7. parameter validation in UI:

    trailing buy activation(drop) percentage  > trailing buy rebound percentage
    trailing sell activation(rise) percentage >  trailing sell Pullback percentage

8. allow user to add new stock symbol to the stock list for backtest, for single backtest, add newly added stock
   symbol to the stock selection list in  batch backtest

9  in the comparison table, please add a button to run backtest again with the same parameters as single backtest
and show detail chart and transaction history. Should open a new tab or window to show the result, and allow
multiple  session can be run at the same time




what is the priority of trailing sell order and trailing buy order?
once a sell order is executed, does it cancel the exisitng trailing buy order?

add a parameter option: max number of lots to sell each time, value can be 1 to max
Currently it is =1, single lot
When it is set to n lots, it will sell the highest n lots that meet the selling condition at the same time, not
just the highest priced lot

still treat it as n separate sell orders, so each lot will have its own sell date, sell price, sell shares, and
return calculation



change it to max 10 lots


Please add annulized return calculation flavor 2: use multiplication instead of math.pow to the log and table

where can I see the average annualized return and compare to buy and hold?


üöÄ Starting DCA Backtest with parameters: {symbol: 'TSLA', startDate: '2021-09-01', endDate: '2025-09-01', lotSizeUsd: 10000, maxLots: 5,¬†‚Ä¶}
App.js:21 üìä Step 1: Running DCA backtest...
App.js:22  POST http://localhost:3001/api/backtest/dca 500 (Internal Server Error)
handleBacktestSubmit @ App.js:22
handleSubmit @ DCABacktestForm.js:11
callCallback @ react-dom.development.js:4164
invokeGuardedCallbackDev @ react-dom.development.js:4213
invokeGuardedCallback @ react-dom.development.js:4277
invokeGuardedCallbackAndCatchFirstError @ react-dom.development.js:4291
executeDispatch @ react-dom.development.js:9041
processDispatchQueueItemsInOrder @ react-dom.development.js:9073
processDispatchQueue @ react-dom.development.js:9086
dispatchEventsForPlugins @ react-dom.development.js:9097
(anonymous) @ react-dom.development.js:9288
batchedUpdates$1 @ react-dom.development.js:26179
batchedUpdates @ react-dom.development.js:3991
dispatchEventForPluginEventSystem @ react-dom.development.js:9287
dispatchEventWithEnableCapturePhaseSelectiveHydrationWithoutDiscreteEventReplay @ react-dom.development.js:6465
dispatchEvent @ react-dom.development.js:6457
dispatchDiscreteEvent @ react-dom.development.js:6430Understand this error
App.js:30 üìä Backtest response status: 500
App.js:74 ‚ùå Error in backtest: Error: Backtest failed: Internal Server Error
    at handleBacktestSubmit (App.js:33:1)
overrideMethod @ hook.js:608
handleBacktestSubmit @ App.js:74
await in handleBacktestSubmit
handleSubmit @ DCABacktestForm.js:11
callCallback @ react-dom.development.js:4164
invokeGuardedCallbackDev @ react-dom.development.js:4213
invokeGuardedCallback @ react-dom.development.js:4277
invokeGuardedCallbackAndCatchFirstError @ react-dom.development.js:4291
executeDispatch @ react-dom.development.js:9041
processDispatchQueueItemsInOrder @ react-dom.development.js:9073
processDispatchQueue @ react-dom.development.js:9086
dispatchEventsForPlugins @ react-dom.development.js:9097
(anonymous) @ react-dom.development.js:9288
batchedUpdates$1 @ react-dom.development.js:26179
batchedUpdates @ react-dom.development.js:3991
dispatchEventForPluginEventSystem @ react-dom.development.js:9287
dispatchEventWithEnableCapturePhaseSelectiveHydrationWithoutDiscreteEventReplay @ react-dom.development.js:6465
dispatchEvent @ react-dom.development.js:6457
dispatchDiscreteEvent @ react-dom.development.js:6430Understand this error
App.js:78 üèÅ Backtest process completed

In "Current Holdings" table,
Current Holdings
Purchase Date
Purchase Price
Shares
Current Value
P&L
11/9/2022
$190.72
52.4329
$0.00
-$10,000.00

please add current price column and use the last day 's closing price as current price to calculate current value
and P&L,
please add annualized return as if we close the position on the last day of backtest, note: it could be negative,
so calcuation could be different? should it be (1 - total return) ^ (365 / total number of days in the backtest
period) + 1
when total return < 0?

all these should be included for average annualized return calculation. please include calculation in the log.


 for each trade : annualized return: (1 + total return) ^ (365 / total number of days in the backtest period) - 1
 include it in the transaction history table and log


 average annualized return for all trades
 then compare to the buy and hold annualized return for the same period.

 calculation of capital utilization rate with time weighted average: it should be calculated as
  (total capital used for buying lots on each day * number of days that capital is used ) / (total capital available *
  total number of days in the backtest period)



In the result table, please use different colum trailing stop buy and trailing stop sell for trailing stop details,
 please include the recent peak and the price when the order is set in the trailing stop buy details, as trailing
 stop buy order is reset as price goes down, the price when the order is set would also be changed. please include
 THAT price for the final order that get executed.


Conversely, please include the recent bottom and the price when the order is set in the trailing stop sell details,
 as trailing stop sell order is reset as price goes up, the price when the order is set would also be changed.
 please include THAT price for the final order that get executed.

move trailing stop details column after the price  column

you can remove OCO details column.

for trailing stop, change the percentage to
   when price rise 20% from the recent  bottom , start a trailing stop limit order.
                                                        stop price is 10% lower than the current price.



let's simplify to use recent peak: the highest price after the last buy or sell
and recent bottom: the lowest price after the last buy or sell

let's use recent peak insead of recent local peak,  and recent bottom instead of recent local bottom
only one term recent peak and recent bottom


I need to make a substantial change to the DCA algorithm.

1. remove OCO order. replace with this trailing stop market order to buy
Buying condition:

when price drops 10% from the recent local peak(please help me define it) start a trailing stop market order.
stop price is 5% higher than the current price. Trailing means if price goes down further, the stop price will be adjusted downwards to be always 5% higher than the current price.
If price goes up, the stop price will not be adjusted. If the stop price is hit, buy at market.
All other buying conditions are kept include the grid price requirement

2. change trailing stop limit trigger condition:

 when price rise 10% from the recent local bottom(please help me define it) start a trailing stop limit order.
stop price is 5% lower than the current price. Trailing means if price goes up further, the stop price will be
adjusted upwards to be always 5% lower than the current price.
If price goes down, the stop price will not be adjusted. If the stop price is hit, sell if all other condition in

All other selling condition are met.

Can you reivew the logic to see any problem and please update the doc first.


There is only orders:
tailing stop limit order for buying
10%

and trailing stop limit order for selling.



but still no OCO trade on the chart! The problem
                                         persist, should you move the chart display logic to BacktestResults.js, so
                                          we know we have the same data to work with or continue to debug the existing code?



add rule, please update doc and code.

do you see the doc need to reorganize since we adding rules on ad-hoc basis?


1. only set trailing stop limit order if the unrealized profit/loss > 0
2. the OCO order should be reset for each sell, by using the current sell price, there can only be one OCO order!






In "Transaction History " table, there are existing columns:
    Date
    Type
    Price
    Shares
    Value"
    Let's add other columns:
    [lots], average cost, unrealized P/L, realized P/L, total P/L, OCO order detail, trailing stop order detail
    when for sell, the lots column will show which lot(s) are sold, realized P/L will be calculated based on the sold lot(s)

    when for buy, the lots column will show the the array of current lots after the buy



  1. Contradictory Stop-Loss Logic

  - Problem: The algorithm sets a stop price at currentPrice * 0.9 but uses the lot's purchase price as the limit price
  - Issue: This can create situations where limitPrice > stopPrice, which violates stop-limit order logic
  - Example: If current price is $100 (stop = $90) but the lot was bought at $95 (limit = $95), the order becomes invalid
RESPONSE: The key is 2.3.3 Lot Selection: Sell the highest-priced lot that is 10% below the current price. If such
lot exist,
 then there is no issue with the above concern.
 If no such lot exist, then we don't create the stop-limit order, so no issue either.
 correct?

  2. OCO Orders Don't Respect Grid Spacing

  - Problem: OCO limit buy orders are set at 10% below sell price, but grid-based buying requires 10% separation from ALL existing
  lots
  - Contradiction: OCO orders can execute even when they violate the grid spacing rule with other held lots
RESPONSE: OCO must also respect the grid spacing rule. If that is not in the implementation, then change it. please
 also make
 it explicit in the spec.
.
  3. Missing Edge Case Handling

  - Gap-down scenarios: If price gaps below both stop and limit prices, the order may not execute properly

RESPONSE:  That is correct. Then a new stop-limit order will be created according to the new current price and the lot selection rule.
  - Multiple lot selection: The algorithm only sells the "highest-priced eligible lot" but doesn't validate if this provides optimal
  P&L
RESPONSE: that is fine
  4. OCO Trailing Buy High Water Mark

  - Potential issue: The trailing buy tracks highest price since sell, but doesn't account for the original 10% drop requirement from
  that high
  - Risk: Could execute prematurely if price fluctuates around the threshold



please review the algorithm and see if any contradiction or problem?



1 disable 2.2.3
2. add one more buying rule after selling a lot: set up a One-Cancels-the-Other (OCO) order:
 a. a limit buy at 10% below the sell price
 b. trailing order that anytime the price drops 10% from the highest price since the sell, buy at market.

3. change "2.3.3 Lot Selection: Sell the highest-priced lot one lot at a time
           2.3.4 Limit Price: Set at (1 - loss_tolerance) of the lot's purchase price
           2.3.5 Stop Price: Max(limit price, current price - 10% of initial price)
           2.3.6 Stop Validation: Stop must be > (1 - loss_tolerance) of limit price, < current price, and ‚â§ (1 - loss_tolerance) of current price" to:
   "2.3.3 Lot Selection: Sell the highest-priced lot that is 10% below the current price.
   2.3.4 stop price: current price * 0.9.
   2.3.5 limit price: the targeted lot price

 4. change "2.4.5 Post-Execution: Remove sold lots, recalculate average cost, clear active stop
to "
   "2.4.5 Post-sell - Execution:
      2.4.5.1 Remove sold lots, recalculate average cost, clear active stop,
      2.4.5.2 set up OCO orders as in 2 above
      2.4.5.3 set up new trailing stop limit order in 2.3



let's remove the drawdown stop loss rule. Instead please calculate the unrealized profit/loss for the remaining
lots % , and do not buy if it is greater than 50% loss, make it a parameter REMAINING_LOTS_LOSS_TOLERANCE, default
to 0
.5.  and explain each value, since it is negative, it is a loss. so -0.5 means 50% loss., greater that 50% loss
means less than -0.5.

Let's focus on the DCA alogorithm backtest now.


This project evolved and has 3 parts:
1. stock data fetcher and db builder, also technical indicator calculator
2. backtest engine for DCA with trailing stop loss
3. front end to display stock chart with buy/sell markers and technical indicators

Can you organize the requirements so far? make each spec numbered and with sub sections if needed.
you did not copy the requirements doc. they are in the old project.

This project probably have some git issues. In intellij project view, I can't even see directory backend and
frontend, even though I can see them in finder.

I like to start with a new project but with all useful code copied over. Can you help me to do that?



1. can find a stock api provider that provides historical daily stock data for free

2. let's make sure the algorithm is correct, we can do a backtest on TSLA  from 2021-11-01 to 2023-11-01

3. the idea is that I can run backtest in command line by  cd /Users/kweng/AI/Stocks
                                                            node backtest_dca_optimized.js, or by UI, and they
                                                            should give the same result given I take the defult
                                                            parameters. However in UI got what is the in the screen
                                                             shot.


                                                            can you compare the reuslt and fix the problem.

should we precalculate the technical indicator and add to db or calcualte them on the fly

can you add a front end to
1 allow enter the back test info:
 // --- Strategy Parameters ---
 const SYMBOL = 'TSLA';
 const START_DATE = '2021-11-01';
 const END_DATE = '2023-11-01';
 const LOT_SIZE_USD = 10000;
 const MAX_LOTS = 5;
 const GRID_INTERVAL_PERCENT = 0.10;
 const REMAINING_LOTS_LOSS_TOLERANCE = 0.05;

2 plot the stock chart for the backtest period with buy and sell markers
3. please plot the technical indicators used in the backtest on the chart, pleaes add preceeding time period to the start date to allow for indicator calculation
4. please plot the complete price chart for all available data in the db with ability to zoom in to the backtest period

it says "No chart data available" when I select "All available data"


API Requests and Data Requirements

## Stock Data Requirements
- Symbol: NVDA
- Date Range: 2021-11-01 to 2023-11-01
- Data Type: Daily OHLCV (Open, High, Low, Close, Volume)
- Source: Database (backend/stocks.db)

## Database Queries
1. Get stock ID by symbol
2. Fetch daily price data within date range
3. Ensure data completeness for backtesting period

## Backend API Endpoints
- GET /api/stocks/:symbol - Get stock information
- GET /api/stocks/:id/prices - Get historical price data
- POST /api/data/fetch - Trigger data fetch from external APIs

## External Data Sources (for reference)
- Financial Modeling Prep (FMP)
- Alpha Vantage
- Tiingo
- Twelve Data

## Data Format
```json
{
  "date": "YYYY-MM-DD",
  "open": number,
  "high": number,
  "low": number,
  "close": number,
  "volume": number
}
```

## Backtest Requirements
- Process daily price data sequentially
- Calculate PNL on each day
- Track lot purchases and sales
- Maintain transaction log
- Generate performance summary
